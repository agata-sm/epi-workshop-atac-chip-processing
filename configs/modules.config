process {

    withName: 'FASTQC_RAW' {
        ext.args   = ""
//        cpus       = 1
//        time       = 1.h
        publishDir = [ 
            path:   { "${params.outdir}/FastQC_raw" },
            mode:   'copy',
        ]
    }


    withName: 'TRIM_READS_PE' {
        ext.args   = "--minimum-length 30 --pair-filter=any"
//        cpus       = 4
//        time       = 4.h
        publishDir = [ 
            path:   { "${params.outdir}/fastq_trimmed" },
            mode:   'copy',
        ]
    }

   withName: 'FASTQC_TRIMMED' {
        ext.args   = ""
//        cpus       = 1
//        time       = 1.h
        publishDir = [ 
            path:   { "${params.outdir}/FastQC_trimmed" },
            mode:   'copy',
        ]
    }


   withName: 'IDX_GENOME' {
        ext.args   = "-q"
//        cpus       = 6
//        time       = 4.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_index" },
            mode:   'copy',
        ]
    }


   withName: 'MAP_READS_GENOME' {
        ext.args   = "--local --very-sensitive -X 1000 --dovetail"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped" },
            mode:   'copy',
        ]
    }


   withName: 'BAM_STATS' {
        ext.args   = ""
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_stats" },
            mode:   'copy',
        ]
    }


   withName: 'BAM_PAIRED_FILT' {
        ext.args   = "-f 0x2"
 //       cpus       = 12
 //       time       = 6.h
 //       publishDir = [ 
  //          path:   { "${params.outdir}/bowtie2_mapped/bam_stats" },
  //          mode:   'copy',
   //     ]
    }



  withName: 'BAM_DEDUP' {
        ext.args   = "-VALIDATION_STRINGENCY LENIENT -REMOVE_DUPLICATES false -ASSUME_SORTED true"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_dedup" },
            mode:   'copy',
        ]
    }


  withName: 'BAM_FILT' {
        ext.args   = "-f 0x2 -q 5"
        cpus       = 12
        time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt" },
            mode:   'copy',
        ]
    }


   withName: 'BAM_STATS2' {
        ext.args   = ""
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt/bam_stats" },
            mode:   'copy',
        ]
    }



  withName: 'BAM_FINGERPRINT' {
        ext.args   = "--binSize=1000"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt/bamFingerprint" },
            mode:   'copy',
        ]
    }

  withName: 'BAM_FINGERPRINT2' {
        ext.args   = "--binSize=1000"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt/bamFingerprint" },
            mode:   'copy',
        ]
    }


  withName: 'BAM_COVERAGE' {
        ext.args   = "--binSize=50 --normalizeUsing RPGC"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt/bw_coverage_1x" },
            mode:   'copy',
        ]
    }

 withName: 'BAM_CORRELATION' {
        ext.args   = "--binSize=1000"
        ext.args2 = "--plotNumbers"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt/bam_correlation" },
            mode:   'copy',
        ]
    }


 withName: 'BAM_FRAG_LEN' {
        ext.args   = "-M 0.5"
 //       cpus       = 12
 //       time       = 6.h
        publishDir = [ 
            path:   { "${params.outdir}/bowtie2_mapped/bam_filt/bam_fragment_length" },
            mode:   'copy',
        ]
    }



    


}

